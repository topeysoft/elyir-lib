author: TopeySoft
description: Shared library for TopeySoft's Elyir Home Automation
type: lib
version: 1.0
manifest_version: 2017-09-29
sources:
  - src
includes:
  - include

config_schema:
  - ["device.id", "ELYIR??????"]

  - ["pins", "o", {title: "Pins layout"}]
  - ["pins.led", "i", -1, {title: "LED GPIO pin"}]
  - ["pins.button", "i", -1, {title: "Button GPIO pin"}]
  
  - ["owner", "o", {title: "Device owner"}]
  - ["owner.uid", "s", "topeysoft", {title: "Owners Unique Identifier"}]

  - ["wifi.ap.enable",  true]
  - ["wifi.ap.ssid", "Elyir_??????"]
  - ["wifi.ap.pass", "elyir678"]

  - ["mqtt.enable",  true]
  - ["mqtt.server", "10.0.1.40:1883"]
  - ["mqtt.ssl_cert", ""]
  - ["mqtt.ssl_key", ""]

  - ["mqtt.base", "s", "users/%s/", {title: "Base topic"}]
  - ["mqtt.pub", "s", "users/%s/devices/%s/publish", {title: "Publish topic"}]
  - ["mqtt.sub", "s", "users/%s/devices/%s/receive", {title: "Subscribe topic"}]
  - ["mqtt.broadcast", "s", "users/%s/devices/%s/broadcast", {title: "Broadcast topic"}]
  - ["mqtt.topic_status", "s", "users/%s/devices/%s/status", {title: "Status topic"}]
  - ["mqtt.topic_get", "s", "users/%s/devices/%s/%s/get", {title: "Attribute set topic"}]
  - ["mqtt.topic_set", "s", "users/%s/devices/%s/%s/set", {title: "Attribute get topic"}]
  - ["mqtt.topic_info", "s", "users/%s/devices/%s/info", {title: "Info topic"}]
  - ["mqtt.topic_info_get", "s", "users/%s/devices/%s/info/get", {title: "Info request topic"}]


conds:
  - when: mos.platform == "esp32"
    apply:
      config_schema:
        - ["pins.led", 13]
        - ["pins.button", 0]
  - when: mos.platform == "esp8266"
    apply:
      config_schema:
        - ["pins.led", 13]
        - ["pins.button", 0]
  - when: mos.platform == "cc3200"
    apply:
      config_schema:
        - ["pins.led", 64]
  - when: mos.platform == "cc3220"
    apply:
      config_schema:
        - ["pins.led", 64]
        - ["pins.button", 15]





# cdefs:
#   MGOS_ENABLE_WEB_CONFIG: 0
#   MGOS_ENABLE_FILE_UPLOAD: 1
#   MGOS_ENABLE_TUNNEL: 0

libs:
  - origin: https://github.com/mongoose-os-libs/ca-bundle
  # - origin: https://github.com/mongoose-os-libs/http-server
  - origin: https://github.com/mongoose-os-libs/ota-http-server
  - origin: https://github.com/mongoose-os-libs/ota-http-client
  - origin: https://github.com/mongoose-os-libs/rpc-service-config
  - origin: https://github.com/mongoose-os-libs/rpc-service-fs
  - origin: https://github.com/mongoose-os-libs/rpc-service-ota
  - origin: https://github.com/mongoose-os-libs/rpc-uart
  - origin: https://github.com/mongoose-os-libs/wifi
  - origin: https://github.com/mongoose-os-libs/mqtt

tags:
  - http
  - c
  - net
